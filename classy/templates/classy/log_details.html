{% load static %}
{% include 'classy/head.html' %}
<title>History - Classy</title>
{% load classy_extras %}
</head>
<body id="bootstrapoverride">

{% include 'classy/navbar.html' %}

    <div id="topicTemplate" class="template container-fluid gov-container">
    <div class="row">
        <div class="col-lg-12">
        <h3 class=""><strong>Detailed view</strong></h3>
        </div>
    </div>
{% if obj %}
<div class="row">


<div class="col-sm-3">
<table class="table">
<thead>
	<tr>
		<th>Category</th>
		<th>Value</th>
	</tr>
</thead>
<tbody>
	<tr>
		<td><strong>ID</strong></td>
		<td>{{obj.id}}</td>
	</tr>
        <tr>
                <td><strong>State</strong></td>
                <td>{{state_translate|get_item:obj.state}}</td>
                <!--<td>{{obj.state}}</td>-->
        </tr>
	<tr>
		<td><strong>Datasource</strong></td>
		<td>{{obj.datasource}}</td>
	</tr>
        <tr>
                <td><strong>Schema</strong></td>
                <td>{{obj.schema}}</td>
        </tr>
        <tr>
                <td><strong>Table</strong></td>
                <td>{{obj.table}}</td>
        </tr>
        <tr>
                <td><strong>Column</strong></td>
                <td>{{obj.column}}</td>
        </tr>
        <tr>
                <td><strong>Created</strong></td>
                <td>{{obj.created}}</td>
        </tr>
        <tr>
                <td><strong>Creator</strong></td>
                <td>{{obj.creator.first_name}}</td>
        </tr>
</tbody>
</table>
</div>
<div class="col-sm-1"></div>
<div class="col-sm-8">
	<div class="row">
		<div class="col-sm-12">
			<div class="well">
				<form class="form-horizontal" method="post">
					{% csrf_token %}
					<fieldset>
						<legend>Masking instructions & notes</legend>
						<div class="form-group">
							<label for="maskingArea" class="col-lg-2 control-label">
								Masking Instructions</label>
							<div class="col-sm-10">
								<textarea name="masking" class="form-control" rows="3" id="maskingArea">{{obj.masking}}</textarea>
								<span class="help-block">
									"How to mask this data element should it be moved to a lower environment."
								</span>
							</div>
						</div>
						<div class="form-group">
							<label for="notesArea" class="col-lg-2 control-label">Notes</label>
							<div class="col-sm-10">
								<textarea name="notes" class="form-control" rows="3" id="notesArea">{{obj.notes}}</textarea>
								<span class="help-block">
									"General notes about this data element."
								</span>
							</div>
						</div>
						<div class="form-group">
							<div class="col-sm-10 col-sm-offset-2">
								<button type="submit" class="btn btn-primary">Submit</button>
							</div>
						</div>
					</fieldset>
				</form>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-sm-12">			
			<table class="table">
			<thead>
				<tr>
					<th>Date</th>
					<th>Action</th>
					<th>User</th>
					<th>Approver</th>
					<th>Old Classification</th>
					<th>New Classification</th>
					<th>Status</th>
				</tr>
			</thead>
			<tbody>
				{% for item in result %}
					<tr>
						<td>{{item.time}}</td>
						{% if item.flag == 1 %}
							<td>MODIFY</td>
						{% elif item.flag == 0 %}
							<td>DELETE</td>
						{% elif item.flag == 2 %}
							<td>CREATE</td>
						{% endif %}
						<td>{{item.user.first_name}}</td>
						<td>{{item.approver.first_name}}</td>
						<td>{{translate|get_item:item.old_classification}}</td>
						<td>{{translate|get_item:item.new_classification}}</td>
						<td>{{state_translate|get_item:item.state}}</td>
					</tr>
				{% endfor %}
			</tbody>
			</table>
		</div>
	</div>
</div>
{% else %}
	<div class="col">
	<p class="text-center"><strong>Invalid ID</strong></p>
	</div>
{% endif %}
</div>
</div>
</div>
{% include 'classy/tail.html' %}
</body>
</html>
